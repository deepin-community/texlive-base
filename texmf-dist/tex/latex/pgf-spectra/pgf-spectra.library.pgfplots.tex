% --------------------------------------------------------------------------------------------------
% subfile of pgf-spectra package -----------------------------------------------------------------
% --------------------------------------------------------------------------------------------------
\def\pgfspectra@library@pgfplots@loaded{}%
\message{pgf-spectra pgfplots library loaded!}%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% provide the macros
%       \pgfspectraplotshade[options]{name}
%       \pgfspectraplotmap[<l|h>]{name}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatletter%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newif\ifpgfspectra@logshade% NEW v2.1.1
\pgfkeys{/pgfspectra/.cd,%
shade begin/.get=\pgfspectra@shadebegin,% NEW v2.1.1
shade begin/.store in=\pgfspectra@shadebegin,% NEW v2.1.1
shade begin/.default=380,% NEW v2.1.1
shade end/.get=\pgfspectra@shadeend,%
shade end/.store in=\pgfspectra@shadeend,%
shade end/.default=780,%
shade opacity/.get=\pgfspectra@shade@opacity,%
shade opacity/.store in=\pgfspectra@shade@opacity,%
shade opacity/.default=1,%
shade opacity color/.get=\pgfspectra@shade@opacitycolor,%
shade opacity color/.store in=\pgfspectra@shade@opacitycolor,%
shade opacity color/.default=white,%
logarithmic/.is if=pgfspectra@logshade% NEW v2.1.1
}%
\pgfkeys{/pgfspectra/.cd,shade begin,shade end,shade opacity,shade opacity color,logarithmic=false}%
% \pgfspectraplotshade{name} or
% \pgfspectraplotshade[options]{name}
% --- recoded in v2.1.1 ---
\def\pgfspectraplotshade{\@ifnextchar[\pgfspectra@pgfspectraplotshade{\pgfspectra@pgfspectraplotshade[]}}%
\def\pgfspectra@pgfspectraplotshade[#1]#2{\ignorespaces%
\pgfkeys{/pgfspectra/.cd,shade begin=380,shade end=780,shade opacity=1,shade opacity color=white,logarithmic=false}%
\pgfkeys{/pgfspectra/.cd,UVcolor=pgfspectraUVcolor,IRcolor=pgfspectraIRcolor,gamma=.8}%
\pgfkeys{/pgfspectra/.cd,#1}%
\pgfmathparse{100*\pgfspectra@shade@opacity}\edef\@pgfspectra@shade@opacity{\pgfmathresult}%
% ---------------------------------------------------------------------------------------------------------------------
% verifying start & end
\edef\pgfspectra@shadebegin@pt{\pgfspectra@shadebegin pt}%
\edef\pgfspectra@shadeend@pt{\pgfspectra@shadeend pt}%
\ifdim\pgfspectra@shadebegin@pt<0pt\relax%
\PackageError{pgf-spectra}{pgfspectraplotshade - minimum wavelength is 0nm!}{}%
\else\ifdim\pgfspectra@shadeend@pt>16000pt\relax%
\PackageError{pgf-spectra}{pgfspectraplotshade - maximum wavelength is 16000nm!}{}%
\else\ifdim\pgfspectra@shadeend@pt<\pgfspectra@shadebegin@pt\relax%
\PackageError{pgf-spectra}{pgfspectraplotshade - shade end must be greater then shade begin!}{}%
\else\relax%
\ifdim\pgfspectra@shadeend@pt<380pt\relax%
\pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
\else%
\ifdim\pgfspectra@shadebegin@pt>780pt\relax%
\pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
\else%
\pgfkeys{/pgf/number format/.cd,fixed,precision=4,set thousands separator={},assume math mode=true}%
%  ----------------------------------------------------
    \ifdim\pgfspectra@shadebegin@pt<380pt\relax%
        \ifdim\pgfspectra@shadeend@pt>780pt\relax%
            % ---------------------------------------------------------------------------------------------------------------------
            % \pgfspectra@shadebegin<380nm & \pgfspectra@shadeend>780nm ----------------------------------------------------
            % Shade structure:
            %       xShade(bp) = f(wl)
            %       x_from_\pgfspectra@shadebegin[bp]@25bp -- x_to_\pgfspectra@shadeend[bp]@75bp:
            %           x_UV_from_\pgfspectra@shadebegin[bp]@25bp -- xUV_to_379.9nm@x_end_UV[bp] --
            %           -- x_VIS_from_380nm@x_start_VIS[bp] -- xVIS_to_780nm@x_end_VIS[bp] --
            %           -- x_IR_from_780.1nm@x_start_IR[bp] -- -- x\pgfspectra@shadeend[bp]@75bp
            % ------------------------------------------------------------------------------------------------------
            % if pgfspectra@shadebegin=0nm let \pgfspectra@shadebegin=0.0001 (log only)
            % (approximation for supporting shading from 0... not a real situation in a logarithmic plot,
            % but not detected in the resulting shade if used for other purposes... )
            % -----------------------------------------------------------------------------------------------------
            \ifpgfspectra@logshade% \pgfspectra@logshadetrue
                \ifnum\pgfspectra@shadebegin=0\relax\edef\pgfspectra@shadebegin{0.00001}\fi%
                \pgfmathparse{(\pgfspectra@shadeend-\pgfspectra@shadebegin)/50}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shadestep}%
                \pgfmathparse{50/(log10(\pgfspectra@shadeend)-log10(\pgfspectra@shadebegin))}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@logscale@factor}%
                \pgfmathparse{25+(log10(379.9)-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                \edef\pgfspectra@X@UV{\pgfspectra@X@tmp bp}%
                \pgfmathparse{25+(log10(780.1)-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                \edef\pgfspectra@X@IR{\pgfspectra@X@tmp bp}%
                \pgfmathparse{25+(log10(380)-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                \edef\pgfspectra@x@start@VIS@log{\pgfspectra@X@tmp}%
                \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{372+8*\n}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{\pgfspectra@x@start@VIS@log+(log10(372+8*\n)-log10(380))*\pgfspectra@shade@logscale@factor}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
            \else% \pgfspectra@logshadefalse
                \pgfmathparse{(\pgfspectra@shadeend-\pgfspectra@shadebegin)/50}%
                \edef\pgfspectra@shade@scale{\pgfmathresult}%
                \pgfmathparse{25+(379.9-\pgfspectra@shadebegin)/\pgfspectra@shade@scale}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                \edef\pgfspectra@X@UV{\pgfspectra@X@tmp bp}%
                \pgfmathparse{25+(780.1-\pgfspectra@shadebegin)/\pgfspectra@shade@scale}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                \edef\pgfspectra@X@IR{\pgfspectra@X@tmp bp}%
                \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{372+8*\n}% MANTER !!!
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{25+(372-\pgfspectra@shadebegin+8*\n)/\pgfspectra@shade@scale}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
            \fi% \ifpgfspectra@logshade
            % the horizontal shading
            \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(\pgfspectra@X@UV)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
            color(\xI)=(wlshcolI);color(\xII)=(wlshcolII);color(\xIII)=(wlshcolIII);color(\xIV)=(wlshcolIV);color(\xV)=(wlshcolV);color(\xVI)=(wlshcolVI);color(\xVII)=(wlshcolVII);color(\xVIII)=(wlshcolVIII);color(\xIX)=(wlshcolIX);color(\xX)=(wlshcolX);color(\xXI)=(wlshcolXI);color(\xXII)=(wlshcolXII);color(\xXIII)=(wlshcolXIII);color(\xXIV)=(wlshcolXIV);color(\xXV)=(wlshcolXV);color(\xXVI)=(wlshcolXVI);color(\xXVII)=(wlshcolXVII);color(\xXVIII)=(wlshcolXVIII);color(\xXIX)=(wlshcolXIX);color(\xXX)=(wlshcolXX);color(\xXXI)=(wlshcolXXI);color(\xXXII)=(wlshcolXXII);color(\xXXIII)=(wlshcolXXIII);color(\xXXIV)=(wlshcolXXIV);color(\xXXV)=(wlshcolXXV);color(\xXXVI)=(wlshcolXXVI);color(\xXXVII)=(wlshcolXXVII);color(\xXXVIII)=(wlshcolXXVIII);color(\xXXIX)=(wlshcolXXIX);color(\xXXX)=(wlshcolXXX);color(\xXXXI)=(wlshcolXXXI);color(\xXXXII)=(wlshcolXXXII);color(\xXXXIII)=(wlshcolXXXIII);color(\xXXXIV)=(wlshcolXXXIV);color(\xXXXV)=(wlshcolXXXV);color(\xXXXVI)=(wlshcolXXXVI);color(\xXXXVII)=(wlshcolXXXVII);color(\xXXXVIII)=(wlshcolXXXVIII);color(\xXXXIX)=(wlshcolXXXIX);color(\xXL)=(wlshcolXL);color(\xXLI)=(wlshcolXLI);color(\xXLII)=(wlshcolXLII);color(\xXLIII)=(wlshcolXLIII);color(\xXLIV)=(wlshcolXLIV);color(\xXLV)=(wlshcolXLV);color(\xXLVI)=(wlshcolXLVI);color(\xXLVII)=(wlshcolXLVII);color(\xXLVIII)=(wlshcolXLVIII);color(\xXLIX)=(wlshcolXLIX);color(\xL)=(wlshcolL);color(\xLI)=(wlshcolLI);%
            color(\pgfspectra@X@IR)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
        \else% \pgfspectra@shadeendt@pt>780pt
            % ---------------------------------------------------------------------------------------------------------------------
            % \pgfspectra@shadebegin<380nm & \pgfspectra@shadeend<=780nm ----------------------------------------------------
            % Shade structure:
            %       25bp -- UV -- \pgfspectra@X@UV -- \pgfspectra@X@VIS@i --- xVIS_to_\pgfspectra@shadeend[bp]@75bp
            %       VIS region in shade (51 points) -> \n=1,2,...,51
            % ------------------------------------------------------------------------------------------------------
            \pgfmathparse{int(\pgfspectra@shadeend-380)}%\pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@VIS@amp@int}%
            \edef\pgfspectra@shade@VIS@amp@int{\pgfmathresult}%
            \ifpgfspectra@logshade% \pgfspectra@logshadetrue
                \ifnum\pgfspectra@shadebegin=0\relax\edef\pgfspectra@shadebegin{0.00001}\fi%
                \ifnum\pgfspectra@shade@VIS@amp@int>20\relax%
                    \pgfmathparse{50/(log10(\pgfspectra@shadeend)-log10(\pgfspectra@shadebegin))}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@logscale@factor}%
                    \pgfmathparse{25+(log10(379.9)-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@X@UV{\pgfspectra@X@tmp bp}%
                    \pgfmathparse{25+(log10(380)-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@X@VIS{\pgfspectra@X@tmp bp}%
                    \pgfmathparse{(\pgfspectra@shadeend-380)/50}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@step@VIS{\pgfspectra@X@tmp}%
                    \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{380+\pgfspectra@step@VIS*(\n-1)}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{\pgfspectra@X@VIS+log10(1+(\n-1)*(\pgfspectra@step@VIS/380))*\pgfspectra@shade@logscale@factor}% correction factor for log10 calc
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \pgfmathparse{\pgfspectra@X@tmp*0.99638}% correction factor for log10 calc
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                    \edef\xLI{75bp}% not always at 75bp... so forcing it!
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(\pgfspectra@X@UV)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
                    color(\xI)=(wlshcolI);color(\xII)=(wlshcolII);color(\xIII)=(wlshcolIII);color(\xIV)=(wlshcolIV);color(\xV)=(wlshcolV);color(\xVI)=(wlshcolVI);color(\xVII)=(wlshcolVII);color(\xVIII)=(wlshcolVIII);color(\xIX)=(wlshcolIX);color(\xX)=(wlshcolX);color(\xXI)=(wlshcolXI);color(\xXII)=(wlshcolXII);color(\xXIII)=(wlshcolXIII);color(\xXIV)=(wlshcolXIV);color(\xXV)=(wlshcolXV);color(\xXVI)=(wlshcolXVI);color(\xXVII)=(wlshcolXVII);color(\xXVIII)=(wlshcolXVIII);color(\xXIX)=(wlshcolXIX);color(\xXX)=(wlshcolXX);color(\xXXI)=(wlshcolXXI);color(\xXXII)=(wlshcolXXII);color(\xXXIII)=(wlshcolXXIII);color(\xXXIV)=(wlshcolXXIV);color(\xXXV)=(wlshcolXXV);color(\xXXVI)=(wlshcolXXVI);color(\xXXVII)=(wlshcolXXVII);color(\xXXVIII)=(wlshcolXXVIII);color(\xXXIX)=(wlshcolXXIX);color(\xXXX)=(wlshcolXXX);color(\xXXXI)=(wlshcolXXXI);color(\xXXXII)=(wlshcolXXXII);color(\xXXXIII)=(wlshcolXXXIII);color(\xXXXIV)=(wlshcolXXXIV);color(\xXXXV)=(wlshcolXXXV);color(\xXXXVI)=(wlshcolXXXVI);color(\xXXXVII)=(wlshcolXXXVII);color(\xXXXVIII)=(wlshcolXXXVIII);color(\xXXXIX)=(wlshcolXXXIX);color(\xXL)=(wlshcolXL);color(\xXLI)=(wlshcolXLI);color(\xXLII)=(wlshcolXLII);color(\xXLIII)=(wlshcolXLIII);color(\xXLIV)=(wlshcolXLIV);color(\xXLV)=(wlshcolXLV);color(\xXLVI)=(wlshcolXLVI);color(\xXLVII)=(wlshcolXLVII);color(\xXLVIII)=(wlshcolXLVIII);color(\xXLIX)=(wlshcolXLIX);color(\xL)=(wlshcolL);color(\xLI)=(wlshcolLI);%
                    color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \else% VIS@amp@int<=20%
                    \pgfmathparse{1/(log10(\pgfspectra@shadeend)-log10(\pgfspectra@shadebegin))}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@logscale@factor}%
                    \pgfmathparse{25+(log10(379.999)-log10(\pgfspectra@shadebegin))*50*\pgfspectra@shade@logscale@factor}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \ifnum\pgfspectra@shade@VIS@amp@int=0\relax%
                        \pgfmathparse{\pgfspectra@X@tmp*0.99621-.1898}% correction factor for log10 calc
                    \else%
                        \pgfmathparse{\pgfspectra@X@tmp*0.99621}% correction factor for log10 calc
                    \fi%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@X@UV{\pgfspectra@X@tmp bp}%
                    \pgfmathparse{25+(log10(380)-log10(\pgfspectra@shadebegin))*50*\pgfspectra@shade@logscale@factor}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \ifnum\pgfspectra@shade@VIS@amp@int=0\relax%
                        \pgfmathparse{\pgfspectra@X@tmp*0.99621-.1898}% correction factor for log10 calc
                    \else%
                        \pgfmathparse{\pgfspectra@X@tmp*0.99621}% correction factor for log10 calc
                    \fi%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@X@VIS{\pgfspectra@X@tmp bp}%
                    \pgfmathparse{(\pgfspectra@shadeend-380)/50}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@step@VIS{\pgfspectra@X@tmp}%
                    \@for\n:={1,6,11,16,21,26,31,36,41,46,51}\do{%
                            \pgfmathparse{380+\pgfspectra@step@VIS*(\n-1)}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{\pgfspectra@X@VIS+log10(1+(\n-1)*(\pgfspectra@step@VIS/380))*50*\pgfspectra@shade@logscale@factor}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                    \edef\xLI{75bp}%
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(\pgfspectra@X@UV)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
                    color(\xI)=(wlshcolI);color(\xVI)=(wlshcolVI);color(\xXI)=(wlshcolXI);color(\xXVI)=(wlshcolXVI);color(\xXXI)=(wlshcolXXI);color(\xXXVI)=(wlshcolXXVI);color(\xXXXI)=(wlshcolXXXI);color(\xXXXVI)=(wlshcolXXXVI);color(\xXLI)=(wlshcolXLI);color(\xXLVI)=(wlshcolXLVI);color(\xLI)=(wlshcolLI);%
                    color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \fi%
            \else% \pgfspectra@logshadefalse
                \ifnum\pgfspectra@shade@VIS@amp@int=0\relax%
                    \wlcolor{380}%
                    \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                    \pgfmathparse{(\pgfspectra@shadeend-\pgfspectra@shadebegin)/50}%
                    \edef\pgfspectra@shade@scale{\pgfmathresult}%
                    \pgfmathparse{25+(379.9-\pgfspectra@shadebegin)/\pgfspectra@shade@scale-.1898}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@UV}%
                    \pgfmathparse{25+(379.99-\pgfspectra@shadebegin)/\pgfspectra@shade@scale-.1898}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@VIS}%
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(\pgfspectra@X@UV)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
                    color(\pgfspectra@X@VIS)=(wlcolor);color(75bp)=(wlcolor);%
                    color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \else%
                    \pgfmathparse{(\pgfspectra@shadeend-\pgfspectra@shadebegin)/50}%
                    \edef\pgfspectra@shade@scale{\pgfmathresult}%
                    \pgfmathparse{25+(379.99-\pgfspectra@shadebegin)/\pgfspectra@shade@scale}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@X@UV{\pgfspectra@X@tmp bp}%
                    \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{380+(\pgfspectra@shadeend-380)/50*(\n-1)}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{25+(380-\pgfspectra@shadebegin+(\pgfspectra@shadeend-380)/50*(\n-1))/\pgfspectra@shade@scale}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(\pgfspectra@X@UV)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
                    color(\xI)=(wlshcolI);color(\xII)=(wlshcolII);color(\xIII)=(wlshcolIII);color(\xIV)=(wlshcolIV);color(\xV)=(wlshcolV);color(\xVI)=(wlshcolVI);color(\xVII)=(wlshcolVII);color(\xVIII)=(wlshcolVIII);color(\xIX)=(wlshcolIX);color(\xX)=(wlshcolX);color(\xXI)=(wlshcolXI);color(\xXII)=(wlshcolXII);color(\xXIII)=(wlshcolXIII);color(\xXIV)=(wlshcolXIV);color(\xXV)=(wlshcolXV);color(\xXVI)=(wlshcolXVI);color(\xXVII)=(wlshcolXVII);color(\xXVIII)=(wlshcolXVIII);color(\xXIX)=(wlshcolXIX);color(\xXX)=(wlshcolXX);color(\xXXI)=(wlshcolXXI);color(\xXXII)=(wlshcolXXII);color(\xXXIII)=(wlshcolXXIII);color(\xXXIV)=(wlshcolXXIV);color(\xXXV)=(wlshcolXXV);color(\xXXVI)=(wlshcolXXVI);color(\xXXVII)=(wlshcolXXVII);color(\xXXVIII)=(wlshcolXXVIII);color(\xXXIX)=(wlshcolXXIX);color(\xXXX)=(wlshcolXXX);color(\xXXXI)=(wlshcolXXXI);color(\xXXXII)=(wlshcolXXXII);color(\xXXXIII)=(wlshcolXXXIII);color(\xXXXIV)=(wlshcolXXXIV);color(\xXXXV)=(wlshcolXXXV);color(\xXXXVI)=(wlshcolXXXVI);color(\xXXXVII)=(wlshcolXXXVII);color(\xXXXVIII)=(wlshcolXXXVIII);color(\xXXXIX)=(wlshcolXXXIX);color(\xXL)=(wlshcolXL);color(\xXLI)=(wlshcolXLI);color(\xXLII)=(wlshcolXLII);color(\xXLIII)=(wlshcolXLIII);color(\xXLIV)=(wlshcolXLIV);color(\xXLV)=(wlshcolXLV);color(\xXLVI)=(wlshcolXLVI);color(\xXLVII)=(wlshcolXLVII);color(\xXLVIII)=(wlshcolXLVIII);color(\xXLIX)=(wlshcolXLIX);color(\xL)=(wlshcolL);color(\xLI)=(wlshcolLI);%
                    color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \fi%
            \fi% \ifpgfspectra@logshade
        \fi% \pgfspectra@shadeendt@pt>780pt
    \else%\pgfspectra@shadebegin@pt<380pt
        \ifdim\pgfspectra@shadeend@pt>780pt\relax%
            % ---------------------------------------------------------------------------------------------------------------------
            % \pgfspectra@shadebegin>=380nm & \pgfspectra@shadeend>780nm ----------------------------------------------------
            % Shade structure:
            %       xShade(bp) = f(wl)
            %       xVIS_from_\pgfspectra@shadebegin[bp]@25bp -- xVIS_to_\pgfspectra@shadeend[bp]@75bp
            %       VIS region in shade (51 points) -> \n=1,2,...,51
            % ------------------------------------------------------------------------------------------------------
            \ifpgfspectra@logshade% \pgfspectra@logshadetrue
            \pgfmathparse{int(780-\pgfspectra@shadebegin)}%\pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@VIS@amp@int}%
            \edef\pgfspectra@shade@VIS@amp@int{\pgfmathresult}%
                \ifnum\pgfspectra@shade@VIS@amp@int>20\relax%
                    \pgfmathparse{50/(log10(\pgfspectra@shadeend)-log10(\pgfspectra@shadebegin))}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@logscale@factor}%
                    \pgfmathparse{25+(log10(780.1)-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                    \edef\pgfspectra@X@IR{\pgfspectra@X@tmp bp}%
                    \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{\pgfspectra@shadebegin+(780-\pgfspectra@shadebegin)/50*(\n-1)}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{25+(log10(\pgfspectra@shadebegin+(780-\pgfspectra@shadebegin)/50*(\n-1))-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.99bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
                    color(\xI)=(wlshcolI);color(\xII)=(wlshcolII);color(\xIII)=(wlshcolIII);color(\xIV)=(wlshcolIV);color(\xV)=(wlshcolV);color(\xVI)=(wlshcolVI);color(\xVII)=(wlshcolVII);color(\xVIII)=(wlshcolVIII);color(\xIX)=(wlshcolIX);color(\xX)=(wlshcolX);color(\xXI)=(wlshcolXI);color(\xXII)=(wlshcolXII);color(\xXIII)=(wlshcolXIII);color(\xXIV)=(wlshcolXIV);color(\xXV)=(wlshcolXV);color(\xXVI)=(wlshcolXVI);color(\xXVII)=(wlshcolXVII);color(\xXVIII)=(wlshcolXVIII);color(\xXIX)=(wlshcolXIX);color(\xXX)=(wlshcolXX);color(\xXXI)=(wlshcolXXI);color(\xXXII)=(wlshcolXXII);color(\xXXIII)=(wlshcolXXIII);color(\xXXIV)=(wlshcolXXIV);color(\xXXV)=(wlshcolXXV);color(\xXXVI)=(wlshcolXXVI);color(\xXXVII)=(wlshcolXXVII);color(\xXXVIII)=(wlshcolXXVIII);color(\xXXIX)=(wlshcolXXIX);color(\xXXX)=(wlshcolXXX);color(\xXXXI)=(wlshcolXXXI);color(\xXXXII)=(wlshcolXXXII);color(\xXXXIII)=(wlshcolXXXIII);color(\xXXXIV)=(wlshcolXXXIV);color(\xXXXV)=(wlshcolXXXV);color(\xXXXVI)=(wlshcolXXXVI);color(\xXXXVII)=(wlshcolXXXVII);color(\xXXXVIII)=(wlshcolXXXVIII);color(\xXXXIX)=(wlshcolXXXIX);color(\xXL)=(wlshcolXL);color(\xXLI)=(wlshcolXLI);color(\xXLII)=(wlshcolXLII);color(\xXLIII)=(wlshcolXLIII);color(\xXLIV)=(wlshcolXLIV);color(\xXLV)=(wlshcolXLV);color(\xXLVI)=(wlshcolXLVI);color(\xXLVII)=(wlshcolXLVII);color(\xXLVIII)=(wlshcolXLVIII);color(\xXLIX)=(wlshcolXLIX);color(\xL)=(wlshcolL);color(\xLI)=(wlshcolLI);%
                    color(\pgfspectra@X@IR)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \else% amp<=20
                    \pgfmathparse{1/(log10(\pgfspectra@shadeend)-log10(\pgfspectra@shadebegin))}%
                    \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@logscale@factor}%
                    \ifnum\pgfspectra@shade@VIS@amp@int=0\relax%
                        \pgfmathparse{25+(log10(780.1)-log10(\pgfspectra@shadebegin))*50*\pgfspectra@shade@logscale@factor}%
                        \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                        \edef\pgfspectra@X@IR{\pgfspectra@X@tmp bp}%
                    \else%
                        \pgfmathparse{25+(log10(781)-log10(\pgfspectra@shadebegin))*50*\pgfspectra@shade@logscale@factor}%
                        \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                        \edef\pgfspectra@X@IR{\pgfspectra@X@tmp bp}%
                    \fi%
                    \@for\n:={1,6,11,16,21,26,31,36,41,46,51}\do{%
                            \pgfmathparse{\pgfspectra@shadebegin+(780-\pgfspectra@shadebegin)/50*(\n-1)}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{25+(log10(\pgfspectra@shadebegin+(780-\pgfspectra@shadebegin)/50*(\n-1))-log10(\pgfspectra@shadebegin))*50*\pgfspectra@shade@logscale@factor}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.99bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
                    color(\xI)=(wlshcolI);color(\xVI)=(wlshcolVI);color(\xXI)=(wlshcolXI);color(\xXVI)=(wlshcolXVI);color(\xXXI)=(wlshcolXXI);color(\xXXVI)=(wlshcolXXVI);color(\xXXXI)=(wlshcolXXXI);color(\xXXXVI)=(wlshcolXXXVI);color(\xXLI)=(wlshcolXLI);color(\xXLVI)=(wlshcolXLVI);color(\xLI)=(wlshcolLI);%
                    color(\pgfspectra@X@IR)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \fi%
            \else% \pgfspectra@logshadefalse
                \pgfmathparse{(\pgfspectra@shadeend-\pgfspectra@shadebegin)/50}%
                \edef\pgfspectra@shade@scale{\pgfmathresult}%
                \pgfmathparse{25+(780.01-\pgfspectra@shadebegin)/\pgfspectra@shade@scale}%
                \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                \edef\pgfspectra@X@IR{\pgfspectra@X@tmp bp}%
                \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{\pgfspectra@shadebegin+(780-\pgfspectra@shadebegin)/50*(\n-1)}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{25+(780-\pgfspectra@shadebegin)/50*(\n-1)/\pgfspectra@shade@scale}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                % the horizontal shading
                \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.99bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);%
                color(\xI)=(wlshcolI);color(\xII)=(wlshcolII);color(\xIII)=(wlshcolIII);color(\xIV)=(wlshcolIV);color(\xV)=(wlshcolV);color(\xVI)=(wlshcolVI);color(\xVII)=(wlshcolVII);color(\xVIII)=(wlshcolVIII);color(\xIX)=(wlshcolIX);color(\xX)=(wlshcolX);color(\xXI)=(wlshcolXI);color(\xXII)=(wlshcolXII);color(\xXIII)=(wlshcolXIII);color(\xXIV)=(wlshcolXIV);color(\xXV)=(wlshcolXV);color(\xXVI)=(wlshcolXVI);color(\xXVII)=(wlshcolXVII);color(\xXVIII)=(wlshcolXVIII);color(\xXIX)=(wlshcolXIX);color(\xXX)=(wlshcolXX);color(\xXXI)=(wlshcolXXI);color(\xXXII)=(wlshcolXXII);color(\xXXIII)=(wlshcolXXIII);color(\xXXIV)=(wlshcolXXIV);color(\xXXV)=(wlshcolXXV);color(\xXXVI)=(wlshcolXXVI);color(\xXXVII)=(wlshcolXXVII);color(\xXXVIII)=(wlshcolXXVIII);color(\xXXIX)=(wlshcolXXIX);color(\xXXX)=(wlshcolXXX);color(\xXXXI)=(wlshcolXXXI);color(\xXXXII)=(wlshcolXXXII);color(\xXXXIII)=(wlshcolXXXIII);color(\xXXXIV)=(wlshcolXXXIV);color(\xXXXV)=(wlshcolXXXV);color(\xXXXVI)=(wlshcolXXXVI);color(\xXXXVII)=(wlshcolXXXVII);color(\xXXXVIII)=(wlshcolXXXVIII);color(\xXXXIX)=(wlshcolXXXIX);color(\xXL)=(wlshcolXL);color(\xXLI)=(wlshcolXLI);color(\xXLII)=(wlshcolXLII);color(\xXLIII)=(wlshcolXLIII);color(\xXLIV)=(wlshcolXLIV);color(\xXLV)=(wlshcolXLV);color(\xXLVI)=(wlshcolXLVI);color(\xXLVII)=(wlshcolXLVII);color(\xXLVIII)=(wlshcolXLVIII);color(\xXLIX)=(wlshcolXLIX);color(\xL)=(wlshcolL);color(\xLI)=(wlshcolLI);%
                color(\pgfspectra@X@IR)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
            \fi% \ifpgfspectra@logshade
        \else% \pgfspectra@shadeend@pt>780pt
            % -----------------------------------------------------------------------------------------------------
            % \pgfspectra@shadebegin>=380nm & \pgfspectra@shadeend<=780nm ---------------------------------
            % Shade structure:
            %       xShade(bp) = f(wl)
            %       xVIS_from_\pgfspectra@shadebegin[bp]@25bp -- xVIS_to_\pgfspectra@shadeend[bp]@75bp
            %       VIS region in shade (51 points) -> \n=1,2,...,51
            % ------------------------------------------------------------------------------------------------------
            \pgfmathparse{(\pgfspectra@shadeend-\pgfspectra@shadebegin)/50}\pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@step}%
            \ifpgfspectra@logshade% \pgfspectra@logshadetrue
                % scale (25 to 75 bp): \pgfspectra@shade@amp=\pgfspectra@shadeend-\pgfspectra@shadebegin ; \pgfspectra@shade@scale=\pgfspectra@shade@amp/50
                \pgfmathparse{\pgfspectra@shadeend-\pgfspectra@shadebegin}\edef\pgfspectra@shade@amp{\pgfmathresult}%
                %\pgfmathprintnumberto{\pgfspectra@shade@amp}{\pgfspectra@shade@amp@int}%
                \pgfmathparse{int(\pgfspectra@shade@amp)}\edef\pgfspectra@shade@amp@int{\pgfmathresult}%
                \ifnum\pgfspectra@shade@amp@int>5\relax%
                    \pgfmathparse{50/(log10(\pgfspectra@shadeend)-log10(\pgfspectra@shadebegin))}\pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@logscale@factor}%
                    \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{\pgfspectra@shadebegin+(\n-1)*\pgfspectra@shade@step}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{25+(log10(\pgfspectra@currentwl)-log10(\pgfspectra@shadebegin))*\pgfspectra@shade@logscale@factor}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                    \edef\xLI{75bp}%
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.94bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.95bp)=(wlshcolI);%
                        color(\xI)=(wlshcolI);color(\xII)=(wlshcolII);color(\xIII)=(wlshcolIII);color(\xIV)=(wlshcolIV);color(\xV)=(wlshcolV);color(\xVI)=(wlshcolVI);color(\xVII)=(wlshcolVII);color(\xVIII)=(wlshcolVIII);color(\xIX)=(wlshcolIX);color(\xX)=(wlshcolX);color(\xXI)=(wlshcolXI);color(\xXII)=(wlshcolXII);color(\xXIII)=(wlshcolXIII);color(\xXIV)=(wlshcolXIV);color(\xXV)=(wlshcolXV);color(\xXVI)=(wlshcolXVI);color(\xXVII)=(wlshcolXVII);color(\xXVIII)=(wlshcolXVIII);color(\xXIX)=(wlshcolXIX);color(\xXX)=(wlshcolXX);color(\xXXI)=(wlshcolXXI);color(\xXXII)=(wlshcolXXII);color(\xXXIII)=(wlshcolXXIII);color(\xXXIV)=(wlshcolXXIV);color(\xXXV)=(wlshcolXXV);color(\xXXVI)=(wlshcolXXVI);color(\xXXVII)=(wlshcolXXVII);color(\xXXVIII)=(wlshcolXXVIII);color(\xXXIX)=(wlshcolXXIX);color(\xXXX)=(wlshcolXXX);color(\xXXXI)=(wlshcolXXXI);color(\xXXXII)=(wlshcolXXXII);color(\xXXXIII)=(wlshcolXXXIII);color(\xXXXIV)=(wlshcolXXXIV);color(\xXXXV)=(wlshcolXXXV);color(\xXXXVI)=(wlshcolXXXVI);color(\xXXXVII)=(wlshcolXXXVII);color(\xXXXVIII)=(wlshcolXXXVIII);color(\xXXXIX)=(wlshcolXXXIX);color(\xXL)=(wlshcolXL);color(\xXLI)=(wlshcolXLI);color(\xXLII)=(wlshcolXLII);color(\xXLIII)=(wlshcolXLIII);color(\xXLIV)=(wlshcolXLIV);color(\xXLV)=(wlshcolXLV);color(\xXLVI)=(wlshcolXLVI);color(\xXLVII)=(wlshcolXLVII);color(\xXLVIII)=(wlshcolXLVIII);color(\xXLIX)=(wlshcolXLIX);color(\xL)=(wlshcolL);color(\xLI)=(wlshcolLI);%
                        color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \else% \pgfspectra@shade@amp@int<5
                    \pgfmathparse{(log10(\pgfspectra@shadeend)-log10(\pgfspectra@shadebegin))}\pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@shade@logscale@factor}%
                    \wlcolor{\pgfspectra@shadebegin}%
                    \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                    \colorlet{wlshcolI}{wlcolor}%
                    \edef\xI{25bp}%
                    \@for\n:={11,21,31,41}\do{%
                            \pgfmathparse{\pgfspectra@shadebegin+(\n-1)*\pgfspectra@shade@step}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{25+(log10(\pgfspectra@currentwl)*50-log10(\pgfspectra@shadebegin)*50)/\pgfspectra@shade@logscale@factor}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                    \wlcolor{\pgfspectra@shadeend}%
                    \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                    \colorlet{wlshcolLI}{wlcolor}%
                    \edef\xLI{75bp}%
                    % the horizontal shading
                    \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.94bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.95bp)=(wlshcolI);%
                        color(\xI)=(wlshcolI);color(\xXI)=(wlshcolXI);color(\xXXI)=(wlshcolXXI);color(\xXXXI)=(wlshcolXXXI);color(\xXLI)=(wlshcolXLI);color(\xLI)=(wlshcolLI);%
                        color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
                \fi% amp>5
            \else% \pgfspectra@logshadefalse
                \@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
                            21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
                            38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
                            \pgfmathparse{\pgfspectra@shadebegin+(\n-1)*\pgfspectra@shade@step}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@currentwl}%
                            \wlcolor{\pgfspectra@currentwl}%
                            \colorlet{wlcolor}{pgfspectra@temp!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor}%
                            \edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%
                            \pgfmathparse{24+\n}%
                            \pgfmathprintnumberto{\pgfmathresult}{\pgfspectra@X@tmp}%
                            \expandafter\edef\csname x\@Roman\n\endcsname{\pgfspectra@X@tmp bp}%
                            }%
                % the horizontal shading
                \pgfdeclarehorizontalshading{#2}{100bp}{color(0bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.94bp)=(\pgfspectra@UVcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(24.95bp)=(wlshcolI);%
                    color(\xI)=(wlshcolI);color(\xII)=(wlshcolII);color(\xIII)=(wlshcolIII);color(\xIV)=(wlshcolIV);color(\xV)=(wlshcolV);color(\xVI)=(wlshcolVI);color(\xVII)=(wlshcolVII);color(\xVIII)=(wlshcolVIII);color(\xIX)=(wlshcolIX);color(\xX)=(wlshcolX);color(\xXI)=(wlshcolXI);color(\xXII)=(wlshcolXII);color(\xXIII)=(wlshcolXIII);color(\xXIV)=(wlshcolXIV);color(\xXV)=(wlshcolXV);color(\xXVI)=(wlshcolXVI);color(\xXVII)=(wlshcolXVII);color(\xXVIII)=(wlshcolXVIII);color(\xXIX)=(wlshcolXIX);color(\xXX)=(wlshcolXX);color(\xXXI)=(wlshcolXXI);color(\xXXII)=(wlshcolXXII);color(\xXXIII)=(wlshcolXXIII);color(\xXXIV)=(wlshcolXXIV);color(\xXXV)=(wlshcolXXV);color(\xXXVI)=(wlshcolXXVI);color(\xXXVII)=(wlshcolXXVII);color(\xXXVIII)=(wlshcolXXVIII);color(\xXXIX)=(wlshcolXXIX);color(\xXXX)=(wlshcolXXX);color(\xXXXI)=(wlshcolXXXI);color(\xXXXII)=(wlshcolXXXII);color(\xXXXIII)=(wlshcolXXXIII);color(\xXXXIV)=(wlshcolXXXIV);color(\xXXXV)=(wlshcolXXXV);color(\xXXXVI)=(wlshcolXXXVI);color(\xXXXVII)=(wlshcolXXXVII);color(\xXXXVIII)=(wlshcolXXXVIII);color(\xXXXIX)=(wlshcolXXXIX);color(\xXL)=(wlshcolXL);color(\xXLI)=(wlshcolXLI);color(\xXLII)=(wlshcolXLII);color(\xXLIII)=(wlshcolXLIII);color(\xXLIV)=(wlshcolXLIV);color(\xXLV)=(wlshcolXLV);color(\xXLVI)=(wlshcolXLVI);color(\xXLVII)=(wlshcolXLVII);color(\xXLVIII)=(wlshcolXLVIII);color(\xXLIX)=(wlshcolXLIX);color(\xL)=(wlshcolL);color(\xLI)=(wlshcolLI);%
                    color(75.01bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor);color(100bp)=(\pgfspectra@IRcolor!\@pgfspectra@shade@opacity!\pgfspectra@shade@opacitycolor)}%
            \fi% \ifpgfspectra@logshade
        \fi% \pgfspectra@shadeend@pt>780pt
    \fi%\pgfspectra@shadebegin@pt<380pt\relax
\fi\fi% \pgfspectra@shadeend@pt<380pt || \pgfspectra@shadebegin@pt>780pt
\fi% \pgfspectra@shadeend@pt<\pgfspectra@shadebegin@pt
\fi\fi% wl<0nm && wl > 16000 nm
}%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \pgfspectraplotmap[<l|h>]{name}
% l -> low resolution (51 colors -> 380 to 780 nm ; step 8 nm) ! Default
% h -> high resolution (401 colors -> 380 to 780 nm ; step 1 nm)
\def\pgfspectraplotmap{\ignorespaces\@ifnextchar[\pgfspectra@pgfspectraplotmap{\pgfspectra@pgfspectraplotmap[l]}}%
\def\pgfspectra@pgfspectraplotmap[#1]#2{\ignorespaces%
\def\pgfspectra@test{#1}\def\pgfspectra@l{l}\def\pgfspectra@h{h}%
\ifx\pgfspectra@test\pgfspectra@l\relax%
\@for\n:={1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,%
21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,%
38,39,40,41,42,43,44,45,46,47,48,49,50,51}\do{%
%\pgfmathparse{380+(\n-1)*8}\edef\pgfspectra@currentwl{\pgfmathresult}%
\pgfmathparse{372+8*\n}\edef\pgfspectra@currentwl{\pgfmathresult}%
\wlcolor{\pgfspectra@currentwl}%
\edef\pgfspectra@colorname{wlshcol\@Roman\n}\relax\colorlet{\pgfspectra@colorname}{wlcolor}%%
}%
% the pgfplots colormap
\pgfplotsset{/pgfplots/colormap={#2}{color(0bp)=(wlshcolI); color(1bp)=(wlshcolII); color(2bp)=(wlshcolIII); color(3bp)=(wlshcolIV); color(4bp)=(wlshcolV); color(5bp)=(wlshcolVI); color(6bp)=(wlshcolVII); color(7bp)=(wlshcolVIII); color(8bp)=(wlshcolIX); color(9bp)=(wlshcolX); color(10bp)=(wlshcolXI); color(11bp)=(wlshcolXII); color(12bp)=(wlshcolXIII); color(13bp)=(wlshcolXIV); color(14bp)=(wlshcolXV); color(15bp)=(wlshcolXVI); color(16bp)=(wlshcolXVII); color(17bp)=(wlshcolXVIII); color(18bp)=(wlshcolXIX); color(19bp)=(wlshcolXX); color(20bp)=(wlshcolXXI); color(21bp)=(wlshcolXXII); color(22bp)=(wlshcolXXIII); color(23bp)=(wlshcolXXIV); color(24bp)=(wlshcolXXV); color(25bp)=(wlshcolXXVI); color(26bp)=(wlshcolXXVII); color(27bp)=(wlshcolXXVIII); color(28bp)=(wlshcolXXIX); color(29bp)=(wlshcolXXX); color(30bp)=(wlshcolXXXI); color(31bp)=(wlshcolXXXII); color(32bp)=(wlshcolXXXIII); color(33bp)=(wlshcolXXXIV); color(34bp)=(wlshcolXXXV); color(35bp)=(wlshcolXXXVI); color(36bp)=(wlshcolXXXVII); color(37bp)=(wlshcolXXXVIII); color(38bp)=(wlshcolXXXIX); color(39bp)=(wlshcolXL); color(40bp)=(wlshcolXLI); color(41bp)=(wlshcolXLII); color(42bp)=(wlshcolXLIII); color(43bp)=(wlshcolXLIV); color(44bp)=(wlshcolXLV); color(45bp)=(wlshcolXLVI); color(46bp)=(wlshcolXLVII); color(47bp)=(wlshcolXLVIII); color(48bp)=(wlshcolXLIX); color(49bp)=(wlshcolL); color(50bp)=(wlshcolLI)}}%
\else\ifx\pgfspectra@test\pgfspectra@h\relax%%
\pgfplotsset{/pgfplots/colormap={#2}{rgb(0bp)=(.3,0,.3); rgb(1bp)=(.3122,0,.3175); rgb(2bp)=(.3238,0,.335); rgb(3bp)=(.3349,0,.3525); rgb(4bp)=(.3453,0,.37); rgb(5bp)=(.3552,0,.3875); rgb(6bp)=(.3645,0,.405); rgb(7bp)=(.3732,0,.4225); rgb(8bp)=(.3813,0,.44); rgb(9bp)=(.3889,0,.4575); rgb(10bp)=(.3958,0,.475); rgb(11bp)=(.4022,0,.4925); rgb(12bp)=(.408,0,.51); rgb(13bp)=(.4132,0,.5275); rgb(14bp)=(.4178,0,.545); rgb(15bp)=(.4219,0,.5625); rgb(16bp)=(.4253,0,.58); rgb(17bp)=(.4282,0,.5975); rgb(18bp)=(.4305,0,.615); rgb(19bp)=(.4322,0,.6325); rgb(20bp)=(.4333,0,.65); rgb(21bp)=(.4339,0,.6675); rgb(22bp)=(.4338,0,.685); rgb(23bp)=(.4332,0,.7025); rgb(24bp)=(.432,0,.72); rgb(25bp)=(.4302,0,.7375); rgb(26bp)=(.4278,0,.755); rgb(27bp)=(.4249,0,.7725); rgb(28bp)=(.4213,0,.79); rgb(29bp)=(.4172,0,.8075); rgb(30bp)=(.4125,0,.825); rgb(31bp)=(.4072,0,.8425); rgb(32bp)=(.4013,0,.86); rgb(33bp)=(.3949,0,.8775); rgb(34bp)=(.3878,0,.895); rgb(35bp)=(.3802,0,.9125); rgb(36bp)=(.372,0,.93); rgb(37bp)=(.3632,0,.9475); rgb(38bp)=(.3538,0,.965); rgb(39bp)=(.3439,0,.9825); rgb(40bp)=(.3333,0,1); rgb(41bp)=(.3167,0,1); rgb(42bp)=(.3,0,1); rgb(43bp)=(.2833,0,1); rgb(44bp)=(.2667,0,1); rgb(45bp)=(.25,0,1); rgb(46bp)=(.2333,0,1); rgb(47bp)=(.2167,0,1); rgb(48bp)=(.2,0,1); rgb(49bp)=(.1833,0,1); rgb(50bp)=(.1667,0,1); %
rgb(51bp)=(.15,0,1); rgb(52bp)=(.1333,0,1); rgb(53bp)=(.1167,0,1); rgb(54bp)=(.1,0,1); rgb(55bp)=(.0833,0,1); rgb(56bp)=(.0667,0,1); rgb(57bp)=(.05,0,1); rgb(58bp)=(.0333,0,1); rgb(59bp)=(.0167,0,1); rgb(60bp)=(0,0,1); rgb(61bp)=(0,.02,1); rgb(62bp)=(0,.04,1); rgb(63bp)=(0,.06,1); rgb(64bp)=(0,.08,1); rgb(65bp)=(0,.1,1); rgb(66bp)=(0,.12,1); rgb(67bp)=(0,.14,1); rgb(68bp)=(0,.16,1); rgb(69bp)=(0,.18,1); rgb(70bp)=(0,.2,1); rgb(71bp)=(0,.22,1); rgb(72bp)=(0,.24,1); rgb(73bp)=(0,.26,1); rgb(74bp)=(0,.28,1); rgb(75bp)=(0,.3,1); rgb(76bp)=(0,.32,1); rgb(77bp)=(0,.34,1); rgb(78bp)=(0,.36,1); rgb(79bp)=(0,.38,1); rgb(80bp)=(0,.4,1); rgb(81bp)=(0,.42,1); rgb(82bp)=(0,.44,1); rgb(83bp)=(0,.46,1); rgb(84bp)=(0,.48,1); rgb(85bp)=(0,.5,1); rgb(86bp)=(0,.52,1); rgb(87bp)=(0,.54,1); rgb(88bp)=(0,.56,1); rgb(89bp)=(0,.58,1); rgb(90bp)=(0,.6,1); rgb(91bp)=(0,.62,1); rgb(92bp)=(0,.64,1); rgb(93bp)=(0,.66,1); rgb(94bp)=(0,.68,1); rgb(95bp)=(0,.7,1); rgb(96bp)=(0,.72,1); rgb(97bp)=(0,.74,1); rgb(98bp)=(0,.76,1); rgb(99bp)=(0,.78,1); rgb(100bp)=(0,.8,1); %
rgb(101bp)=(0,.82,1); rgb(102bp)=(0,.84,1); rgb(103bp)=(0,.86,1); rgb(104bp)=(0,.88,1); rgb(105bp)=(0,.9,1); rgb(106bp)=(0,.92,1); rgb(107bp)=(0,.94,1); rgb(108bp)=(0,.96,1); rgb(109bp)=(0,.98,1); rgb(110bp)=(0,1,1); rgb(111bp)=(0,1,.95); rgb(112bp)=(0,1,.9); rgb(113bp)=(0,1,.85); rgb(114bp)=(0,1,.8); rgb(115bp)=(0,1,.75); rgb(116bp)=(0,1,.7); rgb(117bp)=(0,1,.65); rgb(118bp)=(0,1,.6); rgb(119bp)=(0,1,.55); rgb(120bp)=(0,1,.5); rgb(121bp)=(0,1,.45); rgb(122bp)=(0,1,.4); rgb(123bp)=(0,1,.35); rgb(124bp)=(0,1,.3); rgb(125bp)=(0,1,.25); rgb(126bp)=(0,1,.2); rgb(127bp)=(0,1,.15); rgb(128bp)=(0,1,.1); rgb(129bp)=(0,1,.05); rgb(130bp)=(0,1,0); rgb(131bp)=(.0143,1,0); rgb(132bp)=(.0286,1,0); rgb(133bp)=(.0429,1,0); rgb(134bp)=(.0571,1,0); rgb(135bp)=(.0714,1,0); rgb(136bp)=(.0857,1,0); rgb(137bp)=(.1,1,0); rgb(138bp)=(.1143,1,0); rgb(139bp)=(.1286,1,0); rgb(140bp)=(.1429,1,0); rgb(141bp)=(.1571,1,0); rgb(142bp)=(.1714,1,0); rgb(143bp)=(.1857,1,0); rgb(144bp)=(.2,1,0); rgb(145bp)=(.2143,1,0); rgb(146bp)=(.2286,1,0); rgb(147bp)=(.2429,1,0); rgb(148bp)=(.2571,1,0); rgb(149bp)=(.2714,1,0); rgb(150bp)=(.2857,1,0); %
rgb(151bp)=(.3,1,0); rgb(152bp)=(.3143,1,0); rgb(153bp)=(.3286,1,0); rgb(154bp)=(.3429,1,0); rgb(155bp)=(.3571,1,0); rgb(156bp)=(.3714,1,0); rgb(157bp)=(.3857,1,0); rgb(158bp)=(.4,1,0); rgb(159bp)=(.4143,1,0); rgb(160bp)=(.4286,1,0); rgb(161bp)=(.4429,1,0); rgb(162bp)=(.4571,1,0); rgb(163bp)=(.4714,1,0); rgb(164bp)=(.4857,1,0); rgb(165bp)=(.5,1,0); rgb(166bp)=(.5143,1,0); rgb(167bp)=(.5286,1,0); rgb(168bp)=(.5429,1,0); rgb(169bp)=(.5571,1,0); rgb(170bp)=(.5714,1,0); rgb(171bp)=(.5857,1,0); rgb(172bp)=(.6,1,0); rgb(173bp)=(.6143,1,0); rgb(174bp)=(.6286,1,0); rgb(175bp)=(.6429,1,0); rgb(176bp)=(.6571,1,0); rgb(177bp)=(.6714,1,0); rgb(178bp)=(.6857,1,0); rgb(179bp)=(.7,1,0); rgb(180bp)=(.7143,1,0); rgb(181bp)=(.7286,1,0); rgb(182bp)=(.7429,1,0); rgb(183bp)=(.7571,1,0); rgb(184bp)=(.7714,1,0); rgb(185bp)=(.7857,1,0); rgb(186bp)=(.8,1,0); rgb(187bp)=(.8143,1,0); rgb(188bp)=(.8286,1,0); rgb(189bp)=(.8429,1,0); rgb(190bp)=(.8571,1,0); rgb(191bp)=(.8714,1,0); rgb(192bp)=(.8857,1,0); rgb(193bp)=(.9,1,0); rgb(194bp)=(.9143,1,0); rgb(195bp)=(.9286,1,0); rgb(196bp)=(.9429,1,0); rgb(197bp)=(.9571,1,0); rgb(198bp)=(.9714,1,0); rgb(199bp)=(.9857,1,0); rgb(200bp)=(1,1,0); %
rgb(201bp)=(1,.9846,0); rgb(202bp)=(1,.9692,0); rgb(203bp)=(1,.9538,0); rgb(204bp)=(1,.9385,0); rgb(205bp)=(1,.9231,0); rgb(206bp)=(1,.9077,0); rgb(207bp)=(1,.8923,0); rgb(208bp)=(1,.8769,0); rgb(209bp)=(1,.8615,0); rgb(210bp)=(1,.8462,0); rgb(211bp)=(1,.8308,0); rgb(212bp)=(1,.8154,0); rgb(213bp)=(1,.8,0); rgb(214bp)=(1,.7846,0); rgb(215bp)=(1,.7692,0); rgb(216bp)=(1,.7538,0); rgb(217bp)=(1,.7385,0); rgb(218bp)=(1,.7231,0); rgb(219bp)=(1,.7077,0); rgb(220bp)=(1,.6923,0); rgb(221bp)=(1,.6769,0); rgb(222bp)=(1,.6615,0); rgb(223bp)=(1,.6462,0); rgb(224bp)=(1,.6308,0); rgb(225bp)=(1,.6154,0); rgb(226bp)=(1,.6,0); rgb(227bp)=(1,.5846,0); rgb(228bp)=(1,.5692,0); rgb(229bp)=(1,.5538,0); rgb(230bp)=(1,.5385,0); rgb(231bp)=(1,.5231,0); rgb(232bp)=(1,.5077,0); rgb(233bp)=(1,.4923,0); rgb(234bp)=(1,.4769,0); rgb(235bp)=(1,.4615,0); rgb(236bp)=(1,.4462,0); rgb(237bp)=(1,.4308,0); rgb(238bp)=(1,.4154,0); rgb(239bp)=(1,.4,0); rgb(240bp)=(1,.3846,0); rgb(241bp)=(1,.3692,0); rgb(242bp)=(1,.3538,0); rgb(243bp)=(1,.3385,0); rgb(244bp)=(1,.3231,0); rgb(245bp)=(1,.3077,0); rgb(246bp)=(1,.2923,0); rgb(247bp)=(1,.2769,0); rgb(248bp)=(1,.2615,0); rgb(249bp)=(1,.2462,0); rgb(250bp)=(1,.2308,0); %
rgb(251bp)=(1,.2154,0); rgb(252bp)=(1,.2,0); rgb(253bp)=(1,.1846,0); rgb(254bp)=(1,.1692,0); rgb(255bp)=(1,.1538,0); rgb(256bp)=(1,.1385,0); rgb(257bp)=(1,.1231,0); rgb(258bp)=(1,.1077,0); rgb(259bp)=(1,.0923,0); rgb(260bp)=(1,.0769,0); rgb(261bp)=(1,.0615,0); rgb(262bp)=(1,.0462,0); rgb(263bp)=(1,.0308,0); rgb(264bp)=(1,.0154,0); rgb(265bp)=(1,0,0); rgb(266bp)=(1,0,0); rgb(267bp)=(1,0,0); rgb(268bp)=(1,0,0); rgb(269bp)=(1,0,0); rgb(270bp)=(1,0,0); rgb(271bp)=(1,0,0); rgb(272bp)=(1,0,0); rgb(273bp)=(1,0,0); rgb(274bp)=(1,0,0); rgb(275bp)=(1,0,0); rgb(276bp)=(1,0,0); rgb(277bp)=(1,0,0); rgb(278bp)=(1,0,0); rgb(279bp)=(1,0,0); rgb(280bp)=(1,0,0); rgb(281bp)=(1,0,0); rgb(282bp)=(1,0,0); rgb(283bp)=(1,0,0); rgb(284bp)=(1,0,0); rgb(285bp)=(1,0,0); rgb(286bp)=(1,0,0); rgb(287bp)=(1,0,0); rgb(288bp)=(1,0,0); rgb(289bp)=(1,0,0); rgb(290bp)=(1,0,0); rgb(291bp)=(1,0,0); rgb(292bp)=(1,0,0); rgb(293bp)=(1,0,0); rgb(294bp)=(1,0,0); rgb(295bp)=(1,0,0); rgb(296bp)=(1,0,0); rgb(297bp)=(1,0,0); rgb(298bp)=(1,0,0); rgb(299bp)=(1,0,0); rgb(300bp)=(1,0,0); %
rgb(301bp)=(1,0,0); rgb(302bp)=(1,0,0); rgb(303bp)=(1,0,0); rgb(304bp)=(1,0,0); rgb(305bp)=(1,0,0); rgb(306bp)=(1,0,0); rgb(307bp)=(1,0,0); rgb(308bp)=(1,0,0); rgb(309bp)=(1,0,0); rgb(310bp)=(1,0,0); rgb(311bp)=(1,0,0); rgb(312bp)=(1,0,0); rgb(313bp)=(1,0,0); rgb(314bp)=(1,0,0); rgb(315bp)=(1,0,0); rgb(316bp)=(1,0,0); rgb(317bp)=(1,0,0); rgb(318bp)=(1,0,0); rgb(319bp)=(1,0,0); rgb(320bp)=(1,0,0); rgb(321bp)=(.9913,0,0); rgb(322bp)=(.9825,0,0); rgb(323bp)=(.9738,0,0); rgb(324bp)=(.965,0,0); rgb(325bp)=(.9563,0,0); rgb(326bp)=(.9475,0,0); rgb(327bp)=(.9388,0,0); rgb(328bp)=(.93,0,0); rgb(329bp)=(.9213,0,0); rgb(330bp)=(.9125,0,0); rgb(331bp)=(.9038,0,0); rgb(332bp)=(.895,0,0); rgb(333bp)=(.8863,0,0); rgb(334bp)=(.8775,0,0); rgb(335bp)=(.8688,0,0); rgb(336bp)=(.86,0,0); rgb(337bp)=(.8513,0,0); rgb(338bp)=(.8425,0,0); rgb(339bp)=(.8338,0,0); rgb(340bp)=(.825,0,0); rgb(341bp)=(.8163,0,0); rgb(342bp)=(.8075,0,0); rgb(343bp)=(.7988,0,0); rgb(344bp)=(.79,0,0); rgb(345bp)=(.7813,0,0); rgb(346bp)=(.7725,0,0); rgb(347bp)=(.7638,0,0); rgb(348bp)=(.755,0,0); rgb(349bp)=(.7463,0,0); rgb(350bp)=(.7375,0,0); %
rgb(351bp)=(.7288,0,0); rgb(352bp)=(.72,0,0); rgb(353bp)=(.7113,0,0); rgb(354bp)=(.7025,0,0); rgb(355bp)=(.6938,0,0); rgb(356bp)=(.685,0,0); rgb(357bp)=(.6763,0,0); rgb(358bp)=(.6675,0,0); rgb(359bp)=(.6588,0,0); rgb(360bp)=(.65,0,0); rgb(361bp)=(.6413,0,0); rgb(362bp)=(.6325,0,0); rgb(363bp)=(.6238,0,0); rgb(364bp)=(.615,0,0); rgb(365bp)=(.6063,0,0); rgb(366bp)=(.5975,0,0); rgb(367bp)=(.5888,0,0); rgb(368bp)=(.58,0,0); rgb(369bp)=(.5713,0,0); rgb(370bp)=(.5625,0,0); rgb(371bp)=(.5538,0,0); rgb(372bp)=(.545,0,0); rgb(373bp)=(.5363,0,0); rgb(374bp)=(.5275,0,0); rgb(375bp)=(.5188,0,0); rgb(376bp)=(.51,0,0); rgb(377bp)=(.5013,0,0); rgb(378bp)=(.4925,0,0); rgb(379bp)=(.4838,0,0); rgb(380bp)=(.475,0,0); rgb(381bp)=(.4663,0,0); rgb(382bp)=(.4575,0,0); rgb(383bp)=(.4488,0,0); rgb(384bp)=(.44,0,0); rgb(385bp)=(.4313,0,0); rgb(386bp)=(.4225,0,0); rgb(387bp)=(.4138,0,0); rgb(388bp)=(.405,0,0); rgb(389bp)=(.3963,0,0); rgb(390bp)=(.3875,0,0); rgb(391bp)=(.3788,0,0); rgb(392bp)=(.37,0,0); rgb(393bp)=(.3613,0,0); rgb(394bp)=(.3525,0,0); rgb(395bp)=(.3438,0,0); rgb(396bp)=(.335,0,0); rgb(397bp)=(.3263,0,0); rgb(398bp)=(.3175,0,0); rgb(399bp)=(.3088,0,0); rgb(400bp)=(.3,0,0); %
}}%
\fi\fi%
}%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatother%
\endinput
